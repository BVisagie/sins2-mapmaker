{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Scenario (Galaxy)",
    "description": "Clean-room schema for scenarios produced by sins2-mapmaker. Ensures compatibility with this tool only.",
    "type": "object",
    "properties": {
        "version": { "type": "integer" },
        "skybox": { "type": "string" },
        "root_nodes": {
            "type": "array",
            "items": { "$ref": "#/$defs/node" }
        },
        "phase_lanes": {
            "type": "array",
            "items": { "$ref": "#/$defs/phase_lane" }
        }
    },
    "required": [
        "skybox",
        "root_nodes",
        "phase_lanes"
    ],
    "unevaluatedProperties": false,
    "$defs": {
        "point": {
            "type": "array",
            "items": { "type": "number" },
            "minItems": 2,
            "maxItems": 2
        },
        "ownership": {
            "type": "object",
            "properties": {
                "player_index": { "type": "integer" },
                "npc_filling_type": {
                    "type": "string",
                    "enum": ["militia", "guardian", "enemy_faction", "friendly_faction"]
                },
                "npc_filling_name": { "type": "string" },
                "are_secondary_fixtures_owned": { "type": "boolean" }
            },
            "unevaluatedProperties": false
        },
        "node": {
            "type": "object",
            "properties": {
                "id": { "type": "integer" },
                "filling_name": { "type": "string" },
                "position": { "$ref": "#/$defs/point" },
                "ownership": { "$ref": "#/$defs/ownership" },
                "parent_star_id": { "type": "integer" }
            },
            "required": ["id", "filling_name", "position"],
            "unevaluatedProperties": false
        },
        "phase_lane": {
            "type": "object",
            "properties": {
                "id": { "type": "integer" },
                "node_a": { "type": "integer" },
                "node_b": { "type": "integer" },
                "type": {
                    "type": "string",
                    "enum": ["normal", "star", "wormhole"]
                }
            },
            "required": ["id", "node_a", "node_b"],
            "unevaluatedProperties": false
        }
    }
}